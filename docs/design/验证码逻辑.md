### 图形验证码注册登陆逻辑


1. 注册时必须带上验证码
2. 登陆时，在redis中记录一个账号的登陆失败次数，超过3次就需要带上验证码
3. 需要用到验证码时，前端发起请求，后端返回生成的captchaId，有效期10分钟
4. 前端调用获取验证码图片的接口，再把captchaId的值隐藏在表单中
5. 表单提交后，取出<captchaId, 验证码值>，后端进行判断，如果和用户输入的验证码匹配，则验证成功，此时缓存立即失效。


**安全问题：**

1. 表单必须开启csrf
2. 图形验证码和邮箱验证码接口需要限制同一个ip的请求次数，防止被恶意利用


### 邮箱验证码注册和找回密码逻辑

1. 需要用到验证码时，前端将email作为参数发起请求
2. 后端进行邮箱校验后，再进行发送邮件
3. 用户填写验证码并提交后，前端表单提交后，取出<email, 验证码值>，后端通过email从redis中取出验证码值进行对比，如果和用户输入的验证码匹配，则验证成功，此时redis中缓存立即失效，否则返回失败。

